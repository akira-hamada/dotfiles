#-----------------------------------------------------
# ## tmux references
#
# - cheatsheet: https://qiita.com/nmrmsys/items/03f97f5eabec18a3a18b
# - official: https://github.com/tmux/tmux/wiki
# - https://qiita.com/nl0_blu/items/9d207a70ccc8467f7bab
# - https://qiita.com/shoma2da/items/2e68c1e59938eb0c2f83
# - https://qiita.com/kalafinalice/items/c02c0345293fe60af6e5
# - https://qiita.com/taknya/items/cd7bf686f2a4e71e8af8
# - https://mynavi-agent.jp/it/geekroid/2017/03/-11tmux.html
#
# ## tmux way
#
# - https://qiita.com/nl0_blu/items/9d207a70ccc8467f7bab#tmux%E3%81%AE%E6%A7%8B%E6%88%90%E8%A6%81%E7%B4%A0
# - http://kanjuku-tomato.blogspot.com/2014/02/tmux.html
#
# ## TODO
#
# - read https://github.com/rothgar/awesome-tmux
#-----------------------------------------------------

#-----------------------------------------------------
# # tmux How To Use
#
# ## Session handling
#
# - create session with name `my_session_name`: $ tmux new -s my_session_name
#   - rename session: $ tmux rename -t old_session_name new_session_name (`PREFIX $` in a session)
# - detach session: PREFIX d
# - attach to session of name `my_session_name`: $ tmux a -t my_session_name
#   - attach to the last session: $ tmux a
# - list all sessions: $ tmux ls (`PREFIX l`)
# - quit session: $ tmux kill-session [-t <対象セッション名>]
# - kill all sessions(quit tmux completely): $ tmux kill-server
# - to save current tmux sessions for computer restarting: PREFIX C-s # ref: https://github.com/tmux-plugins/tmux-resurrect#key-bindings
# - to restore tmux sessions even after computer restart: PREFIX C-r
#
# ## Window handling
#
# window is something like a tab of iTerm2.
#
# - create a new window: PREFIX c
# - rename existing window: PREFIX ,
# - move to window commands
#   - move to next window: C-n
#   - move to prev window: C-p
#   - move to a specific window by number: PREFIX number (number is number of window)
# - quit a window: $ exit
# - force quit a window: $ & (when you can't use `exit`)
#
# ## Pane handling
#
# - move to next pane: C-o
# - swap panes: PREFIX C-o
#
# ## choose-mode
#
# - start choose-mode: PREFIX l
# - show sub items: l (at parent item)
# - hide sub items: h (at parent item)
# - quit choose-mode: q
#
# ## etc
#
# - reload tmux config: $ tmux source-file ~/.tmux.conf
# - display key binds: PREFIX ?
# - print tmux version: $ tmux -V
#-----------------------------------------------------

#-----------------------------------------------------
# Settings for tmux
#   to reload tmux config: `PREFIX r` (or $ tmux source-file ~/.tmux.conf)
#-----------------------------------------------------

#-----------------------------------------------------
# set options
#-----------------------------------------------------
# prefixキーをC-fに変更
set -g prefix C-f

# tmux起動時のシェルをzshにする
set -g default-shell /bin/zsh
# tmuxを256色表示できるようにする
set -g default-terminal screen-256color
set -g terminal-overrides 'xterm:colors=256'
# ステータスバーをトップに配置する
set -g status-position top

# 左右のステータスバーの長さを決定する 
# set -g status-left-length 90
# set -g status-right-length 90

# #P => ペイン番号
# 最左に表示
set -g status-left '#H:[#P]'

# ステータスバーを1秒毎に描画し直す
set -g status-interval 1

# センタライズ（主にウィンドウ番号など）
# set -g status-justify centre

# マウス操作を有効にする
set -g mouse on
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'copy-mode -e'"

# コピーモードを設定する
# コピーモードでvimキーバインドを使う
setw -g mode-keys vi

#-----------------------------------------------------
# Key Binds
#-----------------------------------------------------
# C-bのキーバインドを解除
unbind C-b

# vimのキーバインドでペインを移動する
# bind h select-pane -L
# bind j select-pane -D
# bind k select-pane -U
# bind l select-pane -R

# move to next pane in clockwise
bind -n C-o select-pane -t :.+

# list sessions and panes
# ref for choose mode: https://qiita.com/vintersnow/items/3d7e25d520bc7deefc77
bind -n C-l choose-tree -Zw

# reload tmux config
bind -n C-r source-file ~/.tmux.conf

# vimのキーバインドでペインをリサイズする
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# | でペインを縦分割する
bind | split-window -h

# - でペインを縦分割する
bind - split-window -v

# window move
bind -n C-n next-window
bind -n C-p previous-window

# 番号基準値を変更
# set -g base-index 1

# 'v' で選択を始める
# bind -T copy-mode-vi v send -X begin-selection

# # 'V' で行選択
# bind -T copy-mode-vi V send -X select-line

# # 'C-v' で矩形選択
# bind -T copy-mode-vi C-v send -X rectangle-toggle

# # 'y' でヤンク
# bind -T copy-mode-vi y send -X copy-selection

# # 'Y' で行ヤンク
# bind -T copy-mode-vi Y send -X copy-line

# 'C-p'でペースト
# bind-key C-p paste-buffer
#-----------------------------------------------------

#---------------------------------------
# tmux plugins
#   ref: https://wonderwall.hatenablog.com/entry/2016/06/26/195329
#
# ## installation steps
#
# - git clone dotfiles
# - git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm (ref: https://github.com/tmux-plugins/tpm#installation)
#
# TODO
#   - read tmux sensible settings: https://github.com/tmux-plugins/tmux-sensible
#---------------------------------------
# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'dracula/tmux' # dracula color theme for tmux
set -g @resurrect-strategy-vim 'session' # to restore tmux session even after computer restart

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'git@github.com/user/plugin'
# set -g @plugin 'git@bitbucket.com/user/plugin'

set -g @dracula-show-weather false
set -g @dracula-border-contrast true

# Initialize tmux plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
